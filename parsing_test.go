package main

import (
	"os"
	"testing"

	"github.com/hexops/autogold/v2"
)

// to make a test:
// autogold.Expect(nil).Equal(t, got)

func readFile(t *testing.T, path string) string {
	t.Helper()
	output, err := os.ReadFile(path)
	if err != nil {
		t.Fatal(err)
	}
	return string(output)
}

func TestParseBasic(t *testing.T) {
	got := parseDigOutput(readFile(t, "testdata/dig_example_com.txt"))

	autogold.Expect(DNSResponse{
		Status: "NOERROR", ServerIP: "192.168.1.1:53",
		ServerName: "192.168.1.1",
		Question: Question{
			Name:  "example.com.",
			Type:  "A",
			Class: "IN",
		},
		Answers: []Record{{
			Name:  "example.com.",
			TTL:   75789,
			Class: "IN",
			Type:  "A",
			Data:  "93.184.216.34",
		}},
		Authorities: []Record{},
		Additionals: []Record{},
	}).Equal(t, got)
}

func TestParseRootNameserver(t *testing.T) {
	got := parseDigOutput(readFile(t, "testdata/dig_example_com_authority.txt"))

	autogold.Expect(DNSResponse{
		Status: "NOERROR", ServerIP: "198.41.0.4:53",
		ServerName: "a.root-servers.net",
		Question: Question{
			Name:  "example.com.",
			Type:  "A",
			Class: "IN",
		},
		Answers: []Record{},
		Authorities: []Record{
			{
				Name:  "com.",
				TTL:   172800,
				Class: "IN",
				Type:  "NS",
				Data:  "a.gtld-servers.net.",
			},
			{
				Name:  "com.",
				TTL:   172800,
				Class: "IN",
				Type:  "NS",
				Data:  "b.gtld-servers.net.",
			},
			{
				Name:  "com.",
				TTL:   172800,
				Class: "IN",
				Type:  "NS",
				Data:  "c.gtld-servers.net.",
			},
			{
				Name:  "com.",
				TTL:   172800,
				Class: "IN",
				Type:  "NS",
				Data:  "d.gtld-servers.net.",
			},
			{
				Name:  "com.",
				TTL:   172800,
				Class: "IN",
				Type:  "NS",
				Data:  "e.gtld-servers.net.",
			},
			{
				Name:  "com.",
				TTL:   172800,
				Class: "IN",
				Type:  "NS",
				Data:  "f.gtld-servers.net.",
			},
			{
				Name:  "com.",
				TTL:   172800,
				Class: "IN",
				Type:  "NS",
				Data:  "g.gtld-servers.net.",
			},
			{
				Name:  "com.",
				TTL:   172800,
				Class: "IN",
				Type:  "NS",
				Data:  "h.gtld-servers.net.",
			},
			{
				Name:  "com.",
				TTL:   172800,
				Class: "IN",
				Type:  "NS",
				Data:  "i.gtld-servers.net.",
			},
			{
				Name:  "com.",
				TTL:   172800,
				Class: "IN",
				Type:  "NS",
				Data:  "j.gtld-servers.net.",
			},
			{
				Name:  "com.",
				TTL:   172800,
				Class: "IN",
				Type:  "NS",
				Data:  "k.gtld-servers.net.",
			},
			{
				Name:  "com.",
				TTL:   172800,
				Class: "IN",
				Type:  "NS",
				Data:  "l.gtld-servers.net.",
			},
			{
				Name:  "com.",
				TTL:   172800,
				Class: "IN",
				Type:  "NS",
				Data:  "m.gtld-servers.net.",
			},
		},
		Additionals: []Record{
			{
				Name:  "a.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "A",
				Data:  "192.5.6.30",
			},
			{
				Name:  "b.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "A",
				Data:  "192.33.14.30",
			},
			{
				Name:  "c.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "A",
				Data:  "192.26.92.30",
			},
			{
				Name:  "d.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "A",
				Data:  "192.31.80.30",
			},
			{
				Name:  "e.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "A",
				Data:  "192.12.94.30",
			},
			{
				Name:  "f.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "A",
				Data:  "192.35.51.30",
			},
			{
				Name:  "g.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "A",
				Data:  "192.42.93.30",
			},
			{
				Name:  "h.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "A",
				Data:  "192.54.112.30",
			},
			{
				Name:  "i.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "A",
				Data:  "192.43.172.30",
			},
			{
				Name:  "j.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "A",
				Data:  "192.48.79.30",
			},
			{
				Name:  "k.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "A",
				Data:  "192.52.178.30",
			},
			{
				Name:  "l.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "A",
				Data:  "192.41.162.30",
			},
			{
				Name:  "m.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "A",
				Data:  "192.55.83.30",
			},
			{
				Name:  "a.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "AAAA",
				Data:  "2001:503:a83e::2:30",
			},
			{
				Name:  "b.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "AAAA",
				Data:  "2001:503:231d::2:30",
			},
			{
				Name:  "c.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "AAAA",
				Data:  "2001:503:83eb::30",
			},
			{
				Name:  "d.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "AAAA",
				Data:  "2001:500:856e::30",
			},
			{
				Name:  "e.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "AAAA",
				Data:  "2001:502:1ca1::30",
			},
			{
				Name:  "f.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "AAAA",
				Data:  "2001:503:d414::30",
			},
			{
				Name:  "g.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "AAAA",
				Data:  "2001:503:eea3::30",
			},
			{
				Name:  "h.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "AAAA",
				Data:  "2001:502:8cc::30",
			},
			{
				Name:  "i.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "AAAA",
				Data:  "2001:503:39c1::30",
			},
			{
				Name:  "j.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "AAAA",
				Data:  "2001:502:7094::30",
			},
			{
				Name:  "k.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "AAAA",
				Data:  "2001:503:d2d::30",
			},
			{
				Name:  "l.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "AAAA",
				Data:  "2001:500:d937::30",
			},
			{
				Name:  "m.gtld-servers.net.",
				TTL:   172800,
				Class: "IN",
				Type:  "AAAA",
				Data:  "2001:501:b1f9::30",
			},
		},
	}).Equal(t, got)
}

func TestTrace(t *testing.T) {
	got := parseDigTraceOutput(readFile(t, "testdata/dig_trace_example_com.txt"))
	autogold.Expect([]DNSResponse{
		{
			Status:     "NOERROR",
			ServerIP:   "192.168.1.1:53",
			ServerName: "192.168.1.1",
			Question: Question{
				Name:  ".",
				Type:  "NS",
				Class: "IN",
			},
			Answers: []Record{
				{
					Name:  ".",
					TTL:   517950,
					Class: "IN",
					Type:  "NS",
					Data:  "a.root-servers.net.",
				},
				{
					Name:  ".",
					TTL:   517950,
					Class: "IN",
					Type:  "NS",
					Data:  "b.root-servers.net.",
				},
				{
					Name:  ".",
					TTL:   517950,
					Class: "IN",
					Type:  "NS",
					Data:  "c.root-servers.net.",
				},
				{
					Name:  ".",
					TTL:   517950,
					Class: "IN",
					Type:  "NS",
					Data:  "d.root-servers.net.",
				},
				{
					Name:  ".",
					TTL:   517950,
					Class: "IN",
					Type:  "NS",
					Data:  "e.root-servers.net.",
				},
				{
					Name:  ".",
					TTL:   517950,
					Class: "IN",
					Type:  "NS",
					Data:  "f.root-servers.net.",
				},
				{
					Name:  ".",
					TTL:   517950,
					Class: "IN",
					Type:  "NS",
					Data:  "g.root-servers.net.",
				},
				{
					Name:  ".",
					TTL:   517950,
					Class: "IN",
					Type:  "NS",
					Data:  "h.root-servers.net.",
				},
				{
					Name:  ".",
					TTL:   517950,
					Class: "IN",
					Type:  "NS",
					Data:  "i.root-servers.net.",
				},
				{
					Name:  ".",
					TTL:   517950,
					Class: "IN",
					Type:  "NS",
					Data:  "j.root-servers.net.",
				},
				{
					Name:  ".",
					TTL:   517950,
					Class: "IN",
					Type:  "NS",
					Data:  "k.root-servers.net.",
				},
				{
					Name:  ".",
					TTL:   517950,
					Class: "IN",
					Type:  "NS",
					Data:  "l.root-servers.net.",
				},
				{
					Name:  ".",
					TTL:   517950,
					Class: "IN",
					Type:  "NS",
					Data:  "m.root-servers.net.",
				},
				{
					Name:  ".",
					TTL:   517950,
					Class: "IN",
					Type:  "RRSIG",
					Data:  "NS 8 0 518400 20230912210000 20230830200000 11019 . iKKR8LMlixZs53amGnK69lRbb91ttySCHMWjIOzbI3eYCOL4f5ZnyJuY yzo1VWA/TlMCM4NJzScyvIVJS5jaz2oKEUDLzm7v9xoFhYMbBL7y7fc+ 8ByPRZ5rYOcRjhimlToRnAPxh8iXG5xsAmlCJ8+vy00eL7l3Sn8bsQaf x7cvq5ZVYpUZ1jf8S1VhJjHrw8iTNYZHPqmoL7DrzszkKSTrZD5Bmzzt I9qVbpWV69F5cyr/uGo1DhH5Sscz0TVGPBAErFW+EfdO/D491T3Bv1bE MR7+m5TwuQTOs6u4vztRyz+GxvMweSl6xoLxhJ75J+D4snnNZPr+EGGz thIwOQ==",
				},
			},
			Authorities: []Record{},
			Additionals: []Record{
				{
					Name:  "a.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "A",
					Data:  "198.41.0.4",
				},
				{
					Name:  "a.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:503:ba3e::2:30",
				},
				{
					Name:  "b.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "A",
					Data:  "199.9.14.201",
				},
				{
					Name:  "b.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:500:200::b",
				},
				{
					Name:  "c.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "A",
					Data:  "192.33.4.12",
				},
				{
					Name:  "c.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:500:2::c",
				},
				{
					Name:  "d.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "A",
					Data:  "199.7.91.13",
				},
				{
					Name:  "d.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:500:2d::d",
				},
				{
					Name:  "e.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "A",
					Data:  "192.203.230.10",
				},
				{
					Name:  "e.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:500:a8::e",
				},
				{
					Name:  "f.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "A",
					Data:  "192.5.5.241",
				},
				{
					Name:  "f.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:500:2f::f",
				},
				{
					Name:  "g.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "A",
					Data:  "192.112.36.4",
				},
				{
					Name:  "g.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:500:12::d0d",
				},
				{
					Name:  "h.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "A",
					Data:  "198.97.190.53",
				},
				{
					Name:  "h.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:500:1::53",
				},
				{
					Name:  "i.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "A",
					Data:  "192.36.148.17",
				},
				{
					Name:  "i.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:7fe::53",
				},
				{
					Name:  "j.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "A",
					Data:  "192.58.128.30",
				},
				{
					Name:  "j.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:503:c27::2:30",
				},
				{
					Name:  "k.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "A",
					Data:  "193.0.14.129",
				},
				{
					Name:  "k.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:7fd::1",
				},
				{
					Name:  "l.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "A",
					Data:  "199.7.83.42",
				},
				{
					Name:  "l.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:500:9f::42",
				},
				{
					Name:  "m.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "A",
					Data:  "202.12.27.33",
				},
				{
					Name:  "m.root-servers.net.",
					TTL:   517950,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:dc3::35",
				},
			},
		},
		{
			Status:     "NOERROR",
			ServerIP:   "199.7.83.42:53",
			ServerName: "l.root-servers.net",
			Question: Question{
				Name:  "example.com.",
				Type:  "A",
				Class: "IN",
			},
			Answers: []Record{},
			Authorities: []Record{
				{
					Name:  "com.",
					TTL:   172800,
					Class: "IN",
					Type:  "NS",
					Data:  "a.gtld-servers.net.",
				},
				{
					Name:  "com.",
					TTL:   172800,
					Class: "IN",
					Type:  "NS",
					Data:  "b.gtld-servers.net.",
				},
				{
					Name:  "com.",
					TTL:   172800,
					Class: "IN",
					Type:  "NS",
					Data:  "c.gtld-servers.net.",
				},
				{
					Name:  "com.",
					TTL:   172800,
					Class: "IN",
					Type:  "NS",
					Data:  "d.gtld-servers.net.",
				},
				{
					Name:  "com.",
					TTL:   172800,
					Class: "IN",
					Type:  "NS",
					Data:  "e.gtld-servers.net.",
				},
				{
					Name:  "com.",
					TTL:   172800,
					Class: "IN",
					Type:  "NS",
					Data:  "f.gtld-servers.net.",
				},
				{
					Name:  "com.",
					TTL:   172800,
					Class: "IN",
					Type:  "NS",
					Data:  "g.gtld-servers.net.",
				},
				{
					Name:  "com.",
					TTL:   172800,
					Class: "IN",
					Type:  "NS",
					Data:  "h.gtld-servers.net.",
				},
				{
					Name:  "com.",
					TTL:   172800,
					Class: "IN",
					Type:  "NS",
					Data:  "i.gtld-servers.net.",
				},
				{
					Name:  "com.",
					TTL:   172800,
					Class: "IN",
					Type:  "NS",
					Data:  "j.gtld-servers.net.",
				},
				{
					Name:  "com.",
					TTL:   172800,
					Class: "IN",
					Type:  "NS",
					Data:  "k.gtld-servers.net.",
				},
				{
					Name:  "com.",
					TTL:   172800,
					Class: "IN",
					Type:  "NS",
					Data:  "l.gtld-servers.net.",
				},
				{
					Name:  "com.",
					TTL:   172800,
					Class: "IN",
					Type:  "NS",
					Data:  "m.gtld-servers.net.",
				},
				{
					Name:  "com.",
					TTL:   86400,
					Class: "IN",
					Type:  "DS",
					Data:  "30909 8 2 E2D3C916F6DEEAC73294E8268FB5885044A833FC5459588F4A9184CF C41A5766",
				},
				{
					Name:  "com.",
					TTL:   86400,
					Class: "IN",
					Type:  "RRSIG",
					Data:  "DS 8 1 86400 20230912210000 20230830200000 11019 . b0f9IhTkzzSIFp5ioeI5YJbcH3/hAdM1kOxkOF3Tl9f69Pytjw2OdA2S NVkS9Ul1SlZYapCa+OJiyHbDjiV1Ub/kqk6yzg6E1JwVQObfHH9j8zvx SmLzCMLuTVGCFZKNyRa0K6axO+x+ZYpwzul6IVzKREsQC9JdUogygyrO ZymGxDMvSj6d9UXT+g2xVGwfuncFklYAdrtM+z5xYIy0XXQbpsZ6Dqsv T1LR/GKAwGGjNXE2RICg8prz92t36G4WUO/AJuf8FoYGFReK3Vhh4G1H 6AXxSN7tYG2fSJ74qPe95xIV7O5JqULVKdKtCYDo3o71+AziVpAbNS4Z vOEbog==",
				},
			},
			Additionals: []Record{
				{
					Name:  "a.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "A",
					Data:  "192.5.6.30",
				},
				{
					Name:  "a.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:503:a83e::2:30",
				},
				{
					Name:  "b.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "A",
					Data:  "192.33.14.30",
				},
				{
					Name:  "b.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:503:231d::2:30",
				},
				{
					Name:  "c.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "A",
					Data:  "192.26.92.30",
				},
				{
					Name:  "c.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:503:83eb::30",
				},
				{
					Name:  "d.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "A",
					Data:  "192.31.80.30",
				},
				{
					Name:  "d.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:500:856e::30",
				},
				{
					Name:  "e.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "A",
					Data:  "192.12.94.30",
				},
				{
					Name:  "e.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:502:1ca1::30",
				},
				{
					Name:  "f.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "A",
					Data:  "192.35.51.30",
				},
				{
					Name:  "f.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:503:d414::30",
				},
				{
					Name:  "g.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "A",
					Data:  "192.42.93.30",
				},
				{
					Name:  "g.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:503:eea3::30",
				},
				{
					Name:  "h.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "A",
					Data:  "192.54.112.30",
				},
				{
					Name:  "h.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:502:8cc::30",
				},
				{
					Name:  "i.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "A",
					Data:  "192.43.172.30",
				},
				{
					Name:  "i.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:503:39c1::30",
				},
				{
					Name:  "j.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "A",
					Data:  "192.48.79.30",
				},
				{
					Name:  "j.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:502:7094::30",
				},
				{
					Name:  "k.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "A",
					Data:  "192.52.178.30",
				},
				{
					Name:  "k.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:503:d2d::30",
				},
				{
					Name:  "l.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "A",
					Data:  "192.41.162.30",
				},
				{
					Name:  "l.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:500:d937::30",
				},
				{
					Name:  "m.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "A",
					Data:  "192.55.83.30",
				},
				{
					Name:  "m.gtld-servers.net.",
					TTL:   172800,
					Class: "IN",
					Type:  "AAAA",
					Data:  "2001:501:b1f9::30",
				},
			},
		},
		{
			Status:     "NOERROR",
			ServerIP:   "192.35.51.30:53",
			ServerName: "f.gtld-servers.net",
			Question: Question{
				Name:  "example.com.",
				Type:  "A",
				Class: "IN",
			},
			Answers: []Record{},
			Authorities: []Record{
				{
					Name:  "example.com.",
					TTL:   172800,
					Class: "IN",
					Type:  "NS",
					Data:  "a.iana-servers.net.",
				},
				{
					Name:  "example.com.",
					TTL:   172800,
					Class: "IN",
					Type:  "NS",
					Data:  "b.iana-servers.net.",
				},
				{
					Name:  "example.com.",
					TTL:   86400,
					Class: "IN",
					Type:  "DS",
					Data:  "370 13 2 BE74359954660069D5C63D200C39F5603827D7DD02B56F120EE9F3A8 6764247C",
				},
				{
					Name:  "example.com.",
					TTL:   86400,
					Class: "IN",
					Type:  "RRSIG",
					Data:  "DS 8 2 86400 20230906062331 20230830051331 4459 com. GMHHwISDn8Yh8+8Y/aTXu9XkZCobOWJ94nPPPYTvRvpUDJfMHV8k2aSO 9lW6xBjeaWtl9MVBRUKIh6CgLH+hZ/V0UHAROh6mt6jKa/3W35OqcULN 8aRsGujntVlByyD3/1Kxki0S8x+wbbymShuqmXC0KQy7Wl0mkimOCwZD +IDk1UhC5zjZnQjFKmJ4SVLb7ayOsbsoQoufx3BNk2kFig==",
				},
			},
			Additionals: []Record{},
		},
		{
			Status:     "NOERROR",
			ServerIP:   "199.43.133.53:53",
			ServerName: "b.iana-servers.net",
			Question: Question{
				Name:  "example.com.",
				Type:  "A",
				Class: "IN",
			},
			Answers: []Record{
				{
					Name:  "example.com.",
					TTL:   86400,
					Class: "IN",
					Type:  "A",
					Data:  "93.184.216.34",
				},
				{
					Name:  "example.com.",
					TTL:   86400,
					Class: "IN",
					Type:  "RRSIG",
					Data:  "A 13 2 86400 20230909025252 20230819070125 2061 example.com. 8adF5DxheCltQ61A6m5kHUfzgsuhY3zPscP9YDB16sDn2bk6Rw7Fz+gI MiixWE2SkLFl7LWN5cLN7B/aGBGUlw==",
				},
			},
			Authorities: []Record{
				{
					Name:  "example.com.",
					TTL:   86400,
					Class: "IN",
					Type:  "NS",
					Data:  "a.iana-servers.net.",
				},
				{
					Name:  "example.com.",
					TTL:   86400,
					Class: "IN",
					Type:  "NS",
					Data:  "b.iana-servers.net.",
				},
				{
					Name:  "example.com.",
					TTL:   86400,
					Class: "IN",
					Type:  "RRSIG",
					Data:  "NS 13 2 86400 20230909053651 20230819070125 2061 example.com. BbDbIs5CLfsfydzBZOcDqZfwRo/YyDZKeKTs3C6RzGgcC5RpBaXYk7Oh XTZ3OjM3y7YDJVNtuPGcB8Ti7WlMZg==",
				},
			},
			Additionals: []Record{},
		},
	}).Equal(t, got)
}
